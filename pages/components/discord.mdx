import Preview from '../../components/preview'
import { Callout } from 'nextra-theme-docs'

<img src="/images/disc.png" style={{width: "100%", marginTop: '20px;'}} />

# Make Multiplayer Games for Discord Activities
<Callout emoji="👷🏼‍♀️">
  Discord mode is in public preview. Please report any issues or feedback to us on our [Discord](https://discord.gg/bKZUax4uWz) server.
</Callout>

Discord has opened up activities for third-party developers - [Learn more: Discord Embedded SDK](https://discord.com/developers/docs/activities/overview)

While the Discord SDK facilitates the integration with Activities, developers are responsible for maintaining their own multiplayer game servers. Additionally, an authentication server is necessary to generate Discord authentication tokens for players.

Playroom provides deep integration to manage this for you and lets you use Playroom's state sync and other features for your games. You can also host your game on Playroom's Hosting; our ultra-fast CDN.

**Benefits of using Playroom with Discord SDK:**



- 🤼 Puts all players from the same activity in the same room automatically
- 🔒 Handles user authentication for you, you get user's Discord profile directly without doing OAuth dance
- 🔄 Provides a shared room state and player states for each player, state syncs in realtime across all players
- 🎭 Player profile from Discord is available in Playroom's shared state
- 🔗 API to show Discord invite dialog from your game
- ✨ You also get all of Playroom's advanced features like persistence, RPCs, Bots and more

## Setting up

#### Create a Game on Playroom Dev Portal and Connect Discord
Create a game project on [Playroom Dev Portal](https://dev.joinplayroom.com), click on **Discord Activity** tab and follow the instructions to connect your Discord application.

#### Enable Discord in your Game

In your game, add `gameId` and `discord` fields to your `insertCoin` call like this:

```js
import { insertCoin, getState, setState, onPlayerJoin } from 'playroomkit'
// Show popup and ask user permissions for their discord information
await insertCoin({
  gameId: "<id from playroom portal>",
  discord: true
});

// Print current player's server name and avatar url
console.log(me().getProfile())

// Players of this activity session are now in same room now! Set shared state
setState("topScore", 42)

// Called for each player joining the same activity session
onPlayerJoin((playerState)=>{
  // Print player's Discord name and avatar url
  console.log(playerState.getProfile()) // {name: "username", photo: "https://cdn.discord...."}
})

// On some other player
const topScore = getState("topScore")
```

- You can open your game in browser to test it out. Playroom will mock the Discord auth and user profile for you.
- When ready, run your game inside Discord. See [how to load my activity into Discord](https://discord.com/developers/docs/activities/building-an-activity#step-4-running-your-app-locally-in-discord).

<Callout type="info" emoji="💡">
Check out the [Making a Multiplayer Game](/multiplayer) to learn how Playroom works or try enabling discord on any of the [Templates](/templates).
</Callout>


### Inviting Other Players

You can show Discord invite dialog from your game by calling `openDiscordInviteDialog()` method like this:

```js
import { openDiscordInviteDialog } from 'playroomkit'

// ... after game started

openDiscordInviteDialog()
```

### Calling Other Discord Commands

You can get the Discord client by calling `getDiscordClient()` and then call any of the [SDK Commands](https://discord.com/developers/docs/developer-tools/embedded-app-sdk#sdk-commands) directly. 
