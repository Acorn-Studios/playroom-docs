import Preview from '../../components/preview'
import { Callout } from 'nextra-theme-docs'

<img src="/images/home.png" style={{width: "100%", marginTop: '20px;'}} />

# Make Multiplayer Games for Discord Activities
<Callout emoji="👷🏼‍♀️">
  This is a draft of Discord mode. Not currently available in Playroom stable.
</Callout>

Discord has opened up activities for third-party developers. This means, you can make games that Discord users can play directly from Discord Activities. Discord SDK only helps with integrating with activities. You still need to host your own multiplayer game server. You also need an auth server to generate discord auth token for players.

Playroom provides deep integration to manage this for you and lets you use Playroom's state sync and other features for your games. You can also host your game on Playroom's Hosting; our ultra-fast CDN.


## Setting up

For this integration to work, you need to connect your Playroom game to your Discord application.

- If you haven't already, create a game on [Playroom Dev Portal](https://dev.joinplayroom.com) and click **+ Discord** button
- Now create a new application on [Discord Developer Portal](https://discord.com/developers/applications)
  - From **OAuth2 > Client Information**, copy over `CLIENT_ID` and `CLIENT_SECRET` from Discord to Playroom portal so Playroom can manage user authentication for you
  - Add `https://discord.joinplayroom.com/auth` under **Redirects**
- Finally in your game, add `gameId` and `discord` field to `insertCoin` call like this:
```js
// Show popup and ask user permissions for their discord information
await insertCoin({
  gameId: "<id from playroom portal>",
  discord: true
});

// Print current player's server name and avatar url
console.log(me().getProfile())

// Players of this activity session are now in same room now! Set shared state
setState("topScore", 42)

// Called for each player joining the same activity session
onPlayerJoin((playerState)=>{
  // Print player's server name and avatar url
  console.log(playerState.getProfile()) // {name: "username", photo: "https://cdn.discord...."}
})

// On some other player
const topScore = getState("topScore")
```
- Your game is now ready to be embedded into Discord. See [how to load my activity into Discord](#).

<Callout type="info" emoji="💡">
Check out the [Making a Multiplayer Game](/multiplayer) to learn how Playroom works or try enabling discord on any of the [Templates](/templates).
</Callout>


### Other Discord Commands

You can get the Discord client by calling `getDiscordClient()` and then call any of the [SDK Commands](https://discord.com/developers/docs/developer-tools/embedded-app-sdk#sdk-commands) directly. 

### Mock mode

To speed up local development, you can open the game directly in your browser instead of Discord. This will automatically mock the Discord auth and user profile. 

### Running your app locally in Discord

You can just follow [the official steps for loading the game locally in Discord](https://discord.com/developers/docs/activities/building-an-activity#step-4-running-your-app-locally-in-discord).